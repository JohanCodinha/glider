// promisify :: ((a..., b -> ()) -> (), c) -> a... -> Promise b
var promisify = function (f, ctx) { return function () {
    var args = [], len = arguments.length;
    while ( len-- ) args[ len ] = arguments[ len ];

    return new Promise(function (res, rej) {
    var cb = function (err, val) { return err ? rej(err) : res(val); }
    f.call.apply(f, [ ctx ].concat( args, [cb] ))
  });
; }  }

module.exports = promisify
