var curryN = require('ramda/src/curryN')

var validate

try {
  var Joi       = require('joi')
  var promisify = require('./promisify')
  var _validate = promisify(Joi.validate, Joi)
  var defaults  = { abortEarly: false }

  validate = function (schema, x, opts) {
      if ( opts === void 0 ) opts=defaults;

      return _validate(x, schema, opts);
  }
}

catch (e) {
  validate = function (_, x) { return Promise.resolve(x); }
}

// validate :: Schema -> a -> Promise a
module.exports = curryN(2, validate)
